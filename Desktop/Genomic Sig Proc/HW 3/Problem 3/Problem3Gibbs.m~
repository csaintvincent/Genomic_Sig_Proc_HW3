% We are given a set of n sequences. We then guess a1, .. ai, .. , an
% which is the starting position of the motif in each sequence. Since we
% are not given prior information, this is chosen randomly.

% Now we build the q(b,k) matrix and add everytime the S(i)_ai element is
% equal to b. Note: 1<=k = w where w is the length of the motif and k is
% the position after the start of the motif. This builds an initial
% probability weight matrix

% Now that we have done the initial PWM, we must remove an entire in a
% round-robin fashion and re-calculate a probability weight matrix without
% the ith sequence that has been removed. 

% now we find the probabilistic description of ai for every w-long
% word inside sequence i

seq_array = [
    'TTCCGATTTTCGTCGGCGCGAGTCGTG';
    'TTCCGATTTTCGTCGGCGCGAGTCGTG';
    'TTCCGATTTTCGTCGGCGCGAGTCGTG';
    'TTCCGATTTTCGTCGGCGCGAGTCGTG';
    'TTCCGATTTTCGTCGGCGCGAGTCGTG';
    'TTCCGATTTTCGTCGGCGCGAGTCGTG';
    'TTCCGATTTTCGTCGGCGCGAGTCGTG'
    

];

s1 =  'GCACCACCGGAGGTCACCTCTACAGGTGTTAACCCCCTTTGACCGCAGTGAGCCATCCTATTCATCCCTCGAGTTGCACTCCTGGTGACTCGGCCAATACGCCATTGACAGGGGCCACCCTGAAGTGAAAATTAGGCCAGAGTTCTAACACACACCTGTAGCTGTAACTAGCTACTGTGATGCGGACCACACCAGATCCGTAGAAAGGATTCGAATTCGAAGGGAGGCTTCAGAACCCGCCATTTTTTGATCTGTCCGTGAAATTCGAATTCCCCGAGTCCTAGCCCTGGCTTCTCAGTTCTTCGCGGGGCGTTCATTGTAGTGATTAGCATTCGGCAAAAAAAGCGATGGTGCCCCGTTGAGAGTCCCTACAGCCGATTGGCCCTTTCGGGTGGAGTAGCGAGGAACCACGGCCATCATAGCTGCTCGCGAGCTCTATTTGCTCGCAGTATTTGTCGACGCAAAAGCTTGCGGTGCCGGATAGAAACTCTATTCGAATTCTCTGAATACCCAGTTCTACCGCCTAGCTACCTCTTCGCAAGCGGTAGGTTCCTACGCCCTTGTGAGCTGGTGCGACTCGTAAAAAGACTATGTTATCTATACTTATACAGAGGCAGTTCGTTCAAACCTGAGTCTCAAGACTAGCGGAACTTTGCATAAGTGTCTTGGGGCTTAAGACTGCCATAATCTCTTGCTACACAGCTTGCGTATCGCAGAGGGCGGGCAGTGGACAGCACGGAGATCTGTAATAGTTTCTATAGGACGAATCACATTCAGGGAAAGTTGCCCGAGATCCATTCGAATTCCCTGCAAGTCATTGCGTCCGTGCGAGATTCGAATTCCGACGTGATTGCTAATGTAGCGCCTATAGGGGGGAAGGCAGAAATACTTACGCGGTGTACTCGGCCTTTTGCTGTACATTAAGATCTCAGTCCTGTGACTCAGATCTCTAACTGGGTGATAGTACATAAGGCTCTGAGACGAAGCACACAGACCGTACTGCCGGGTAGTTTCCTTCGA'; %ACTTATCGCGCAGATACCATGTAACGGGCA';
s2 =  'GTGTCCACATCTGTAGTACGACAATTTCAGAGCTCCCTTATGACACACTATGGATCGAGTAGTAGTATAATTCGGTGATAAAATTCGTGTCCGAACTTCGGGTAGCAACAAATATATCGTCCGGCGAGGTTTACCGATCCGGAATGGCTGTAACGGTAGGACCGCCATTCCCTTTTACATCCACCCAGGGTCTTGGTGCATGGAGTAACTTAATTCCTATCCTTGGAAACGCTCCTATCCAAGACCTATGGAGCTATTAAAAACACCCGAGACAGTACAGTATTCGAATTCAACAGCTCCCACGAATCAAGGATACTCCCGTAACGTCTCCCCCAAATGGCCTTAAGCTACTAGTGCTTTGTATTCTCGAACTGCTTGGAGGCCATGATTCGAATTCCTCACTACTGAAGTATGAGCCCCGCTGTCGATTCGCCTATGGGAAGATTCGAATTCATACGAATCTTCGTCATAAAGCTATTGAAAGGCTACGAGCACGCGTTATATATCTGTTGTGCGGTCATACTGACCTGACGAGACAAATTTGCGGCACTAGTAGTGATTCGGCTCACAACCCGCTTCGTCCGCAGTACCCGCCCACATGTATACAAGGGCTAGAGGAAAGTTTGGGATGCGGCAAGTAGCCAGGATTCCCAGGAAGTGACCCCTGAAGCAATCATTGACGCACAACTAATTCCTTCTGACGGGAGTAAGGCAGGAACTCTCGTGCCTCGTATCCATATTCGAATTCGAAATTCTCATCACACTGACGAGCACCCCTGGCCAACAACGAATATTCGTACGTTTAGCGTACTGTAATGTTCCAACTAGCACGGGTAATGCCTGTTGGCTGGAACTTTGCAAGCAAGTCTCGGGTGGAGTTTCTTTCTAGCGCAGAAATTCGAATTCGCTTCCCGAAAGCCTTCCTGGGGGAACTATTAAGTCGCTAAGGTAACAAGGTCACGAAGGGAGGCAGGCGATTGCGAGGCGGCATTCTGGACCGTACATCCTAGGGCCCTAGGA'; %TAAGGTCCGCTATGCAAGGCTGGTCACCCG';
s3 =  'GGCGGTAGCCCTATAGCATATGGCGTGCAGCGAGAATGACCACCGCATATAGCTTGCGTCGCATCGAAAGGCTATTTGGGGCAGCAACGAGCGCGAATTCATTTGTCAAACTGGGTTAGAGCCTCAAAAGTGACTTCTCGGTAGTGAGAGGATTCCAACATCTGGCCTTCCGTCACCTTCACGACCTTCAGAAGAAGCCTTCGCTACTAGTAGATCCGACACACTATCGAGAAGTGCTTGGAGTGAGTCAACCAATGAGACGTGCTCCTTAAAAGAAGGTCATCACTACTTTGGGACCAACTAGTACTTGTTAGCCTGTTGACCTCGGCCTCAACAAAATGAGAAGGGCGGCGGGTCGCCGGCAGTTCAACCATCACACTCGGGCGCCCCATGCTTCAGCCGACAAGATTCACTATGTGTACCGTCACCGAACCCAGCGTTCCCCCTATCAAGGAATTCGAATTCTGGCCGCTTAAGTTCGTTGTCGTAGCACGTCCTTGGGCCGGCCTCCCTGACGTAAGGGTACCACTTACTGTTCGGTCTGGAAATATAAAACGACAGTGCAGCACCCAGGCGACCTTCGAACAACGAGGAAATACAGAGGTCTTTGATAGTTAGCCTTGGAATTCGAATTCCAGTAAGTTTAAACTTGGATGGCAACCTTCCTAAAGTCCAGGTATGCTCAGAGATATATGGCTTTCGATAGCACCCCTAGGGGTGGGGGTGAATTGATGAGGGTATGCGGCACGAGTGTCCCTGTATTCGAATTCCGATGCGGTAAAAGGCCAGTTCGATCATGCCTTTAGACTATACAATCTAACTATCATCGTATAACGGTTCTTCTTCTCTCTCCTCATTGGTCCCCACTCCTGCTGCCCAAGATTGGCCATGAGCTGTAAGCTCGATAAGGAAGTACATAGCGCTGACTTTTGATAGCCTATGACACGGCAGTTACGCTCTTCTTGACTTCCACTTTGGACGGTGTAGGCGGCCGAAAACCAGCTTTATCGTACCGTTGTG'; %TAAT';
s4 =  'ATTCGAATTCGTCTGGAGTATTGTGCGTCGAAAAGGCGAATGTAGTTACATACACCCAGTAACTGCAATCCACTCTTGGTTTAACCGAAAGTACCATGGGGAGGTTGCGGGCCTCACTTAGCGTTACTAGAAGGGGTACCTGACTCAATGTGCGTCAGTCACCCCCCGCCCAGTGCGGTAACTACATACGTCCTGTCTCCGGCTGAGGGAAACAATTCGAATTCGAAACGTTACGCGCATAAACCCTCTCTGCTTTATAGGGCACAAGCTACGTATTGCTACCGTGTCAAGAACAGAGCGAGATCGAGAAGCAGCTGGCTTAGAGTTCTTACCCATTCGAATTCTCACACTCGCCCAAGGATTGAAGTGACAGCTGATTGATCCTCTAATCCAGGTGAAAACAGGCATTTCGAAACTAGGGGGGTAACGAGGGTCGCGCTCACCCTTGAGTGACATGCACTGTGACTCGTATGTGAACTGCCCGAATCGCGGTTTCACATTCGAATTCGCGTGTGATGATCGGCTGTGGCAAGCGGTCCCGACTACCTTGATTCGAATTCCCTTATTCCGTCATAGTGTCGTGGTTAGAGATCGCCAGATTCGAATTCATTGCGAGCCCTATTGTGCATAAACTACAGTTCCAGGGACATTCAGATTAATTGAACATCGCTTGTGACTGCGCCCGACCACCCCTGCACTTCCATTCGGAGGCCCTTGTCGGGTGCGTATTCAAACATTCGAATTCCTGTCGCGCGTGGACGGTGTGCAAATTCGAATTCTGATGTGGGAGTATAACATCGCGGTTAAAACCGAGACCGGCCACGAGCCAACAATTCGAATTCCCGTCACTACTTATGATTGGGATACCTTGATATGGGTGAAGACGTAATTTACTCTTGTTGATCATTCCGCCTTCGCGTGCTATGTCGCCGTTTAGTGGAGGGCTTGTTGATTCTACGCGATTTAACTGACCAGCTAGAGCTCCGGACTCACTTGTTCTTGCTAGGGGTTGTTATTATA'; %TCCTTTAGTTGGTCGTGAACATGATACCCTCTCTCTAAGTGATTTTGGCGAGGGCTGACTAGTGCTTGGT';
s5 =  'GCCCACCCTAAAATTGCCAGTTGCCTGCTTCAACCGGTCACGGGCCTGCTAGTCCGGGTTGAGTTGGCTGCAATTCGAATTCTAAGACCAGACATGGAAACACCCACCAAAAGGTGGAAAATTAAATAAACCGGATCACTGGTCCGCGTGTGAGCTAGTGAGCAAAATTGCCTCTTGAGGCGAAACCAGCTGATAAAAGCAGCCGGGTATCAGGTGTCCGATGTGGAGCGGGTATCTAGCCTCCGCCTGCAAAGGCAGAAACCGTCTTGCCGCACGCGCAAGCCCAATAGCTACATATCAATTTGAAGACAGTAATTTGGAGGGCTGGTCAAGCAGGGAGAACGTCAAAGCATCAAGGTCCTGTTGCGCGTATATAATTCGAATTCCTGCTTCCATAGAACTTAGGTCACATTCGAATTCTCAAGTGGTCACCGCAACAGCCGGGTGGTTGAATAAGGAAAGGTTTCGTGCTACTGGCGGACCTTATAACACAAAATTCGAATTCTGCACGTTCAAGCAGAATAATTGAGCTATTTCGAATGTGGCCCTCTTCGAACAGTCCACGGTATAACGACGTGGGTAGCGTATTCGAATTCAGGACCTATTTAAATGAGGCGACAGCCATGGTGGCTTATTCCACTTATTCGAATTCCCCCACTTTACATACGACCATAAAACCTAGATTGTAGCGCAAAGGTAGGGGCAGTTCCGGGCCTGCATCTCTCCTAAGAGACCCATATGGTCGTTCGAGTGACGTTAAGATTCGAATTCGTTGAGGAGCACCACGCACTGCGTACAACAGTCTTGGCTGGTGTAGTAGGGCCTATTTAACTGCTTGCAAAGATCCTCCCCGGCGTCAGCAGGGATTCGAATTCGTGCGATGTGGAGCCTAGCTACGGATGGGACGGTGTTGATAAGTAGGAACCACTGATCTCTTGAAAGGCGTGGGAACGCTATTAGTGGTGCGTGTCGCGCATTAAAGCAACGGCACATCTATTCGAATTCACGTTGGCGTACCAG'; %TTCAGCCCATGCCAAGGTTCGCAGGCGTCAGGCACCCCATCAGGAACCCGAGAATGAATTTTGGTGAAAA';
s6 =  'GGGGTAACAGCAGGAAGAGCAGGCTCATCACTGCTTGAGCATTGGTACCCGAGAAAGCTATATGCCGAAACTGGGCTGAATTTACTCTGTAAGAGAATAGACGCGACAAACGCTTACGGTTTTGAACCGTAATAAGATGTGGACTCTTGGTATGCGGACGCATCTGCGGGGTAACCAACAAGCAGAATACAAAAGCCAAGCACCAACCCAGGCGATGCGCGCAGAAGGAACCGGGCAAGAGCAATCAGCCTCTTGCTGGGAAGATTTGCCATATGTGCTTTGCTGCTGACCACGAGACGGCTTACGCTTCGCATTCGAATTCGAAGTCAAAGTTGCCGAGGTATTGATTCGAATTCAAACGCGAATCCTGGAGTAAGGCCGCCTGGGGCGATGATTCGAATTCTTATTCGAATTCGAGTTAAATCAGGGGTCTATCGATATATCTGCCTCTGGTGTCGAAGGTGCAAGGAGTCATTAGGCCTGCCCCACTGTAGACTGGATCCCATATTTTTAGGAGGTGTCTTTGAATTCGAATTCCACCGTTGAGCGGACCCCATCTGCGACTGGGTCGGCACAGTTTCGCTGGAACGTTTGACTGATTGCCGCGTACCTGTGCCGAAGCGGTGGAAGCTCCGAAAGCCCTACCAGGACGACTGAGTTTTGTTTCCCGACTATCTGCACTGATGCGGTCCCTTGGGCAAGCCAACATTGCTAGTCTTCTAGGCCTGGATAGCATTCGAATTCGCTGGCGGTAGAGCTGGGCCAGAAAGTGGCCAACTAGGTTCAGACACCCATCGCGCTACTCCTGGTTCCCATCGACATATAACACCCCAAGAGCATCTGTATGCTTGTGGCATATTCGAATTCTCGTAAAGGCTCCTATCCAACGGCCGTCAATAGTGTGACGACGTATTGGTCCGACCCTGGAGCCAGGACCTTCCCGGGAGCCAAGAGCTCAACAGGGATGCTCGTTTTCTAGGCTCTACGAAAGGTCTGCGTAGTATTTCACCGGACGAGGTA'; %ACCAATAGGCTGTCGAGTTTCCTATGCACTGGGGGTGGTTTTCTGGTCCC';
s7 =  'AATCGGCATTAGTGTCCAGGTGTATGCGATCGGTGTCTATCGATGTGGCCCATGAAAGAATCCTAGACTGGGCGCTGCGAGACGCCGATGGGTTCCTATAGATAGAGAGACTAGATTCAGGGCATTGTGATTGTGCAAAGCGATCGCTGGACGAGAAGGGCAGGTCGATCCTTTAACCCGGTTAACTCCCAGATGCAAGAGTGTACGTATGCTCTTGCTGTAATACTCGTCCTAACATATTAGGCTCACGACGCAATACAAACAACCTCTCTTAGTGGCCAAGCAAATTGGCCTATCACGGATTGAAATTGGCGGTGTCGTGTGGATGTGTGTGCGTCTGACCATAGGCCGGGAGCCAGTAAACGCATTGGGGAATGGTCAAGTGCTGAGTCGTAATTAATTCGAATTCTGCAAAACGCGCGTGCATTGAAATCTGCGACTGCGAGGTCGTCTGGTTACTAATGGGGACGGGGGTATCTATTCGAATTCGCGTTCTGGGGCTCGGAATCTTATCGAGTCAATAGACCCGCTCGTCTTTGACACTAAGTTGGCCTTTTACTATTTGCGTTGACCAGGTATTTTTAAAGGATAATGTTCCGATTCGAATTCGTGACGCGTCTCCCCTTGACCCTGACTTCCAATCGAGACGTTAAGAGGCCTCAAACGTACCAGGTCTTCTGACTAATTCGAATTCAAACTCGGGGCTACCACCAAGCTCCCTAGTCCAGACGAGTCCATTCGTTTTGCACAATTACTCCGTCCTTCTGCTCGCCGAGGTGCAGCTGTGTGGTCACGTCAATTGTTCCCCACAGTGGAACTTGGCGCATTTTACCGGCGAGCCTCTCTTAATTCGAATTCCCCACATGTTAATCCGGATCCCAGGTGACTACACGTGAGGGCGTTGTCCTTGAAAGCCCTTAACAGCGTGCGAACACATAGTCCGCTCCAGTTTGCACCTTTAGTTGTCCTCTGTGGTTCTGTGTCCTGCTATGTGAGGCCACCTGCGAGCATACGGATCTA'; %GTCGCTGTTAACCCGATCAAATTCAGCTGC';
s8 =  'GGTTAGCACACACATTCCACAATAACGCTGAATCCCTCACTCCGTAGGGCAGATCTGGACGTGGGCTTAAACCAGACCGGAGGCAGGAGTCCGTCAAATCACTAGTTAATATTGAGTACAGACTCGGGATTGGCGATGCGTTCGGGCGCCATCCATTTGAATGGACTTCTTCGAGTAGTTTCCATTCCTTTCTCTACTACGCTCATTGGGTACATATCGGCCGAAACAGGAACGTCACAGGTCACTCGTGGTGCAAGTATTATGCCGATCTCCACATTTTAGGAGACCCCACTGAACAACGGATAACATCCTAAAGACCAGGCTCCGTTTTATCCGCACACGGAACGGGTAGGTATTCCTGTATTTCAGTGGCAATTCGAATTCAGAACGCGAATGCCAGGGGGATGAGAACCGTACACTCGGTAGGACCTGCGGTAGCTTAATTTCGGCTGCATTCGTCAGCGCAGCAATGCTTCCACATTAGCCCGTTAGCTGCTTAACGGAGCTAGTTACCAAGCTCCGGGGAGGCTCTAACAGGTAAAAAATCAGCTTTGTAGTGAAAGTGGGCAGTGGTTAAAGACTTCTACCTGTGAAACATATGTCGCAGGCGGCAGAACCGTATAGAAGAACATTCGAATTCCTGCACGAGGGCCGTTTCTCAGAGTATTGGCCAACCCACCCCTGTCTTGGGGCCCTTACCACGAGGGGAGTACTATTATTCGGTCAGTAACAATTATTGGAACACACTCCGCTCCGGTCACCGACTACTGTATTCGAATTCTAAGACGTGTTGAAATGGAGATTCGAATTCCCTACACTATGAACCGTGTATCATGGGAAGTCAAGGCTACTGGGATGCCCTTCGATCGAGAGACCACTGCCGACAGTCCGGGGCTGAGGTATGCCGGGTTCTACTAATTCGGGAGGTGTGGCTCATACAACATCAATTGGCGGCATCTATGGCATTTCCGTTGGGGGAGTACTCTATGGATCCCTGGTCTGCTTAGGGGAGGTTACTGG'; %TGGCCCAGGTCAGTGTAAAT';
s9 =  'ATCGCAGAATCTCTGCCGCACCCCGTAGCACTCAATCGATATCAGACCATCCTTCCATACACCTCGCGTGCAGTGGCTAGTTAACTCGAGTCGGTTTTGCTGCGTAGAAAGTCGGATCTTGTGTTGGGGGATTCCTATACGCTAGATCGTTCAACTTTTCACTACAAGAATATGGCTTTCGTCAAACCAATTCGAATTCCTACTCCGTACCGTTCTTTGACGTTCACATCACTAATCAGCCCGGCAACATCGTCTTAAACGGGGTGGACGCCTTCCCTTTGGGGACGCGCCAGACGGTCTCTTAGAATTCCGTTAAGGATGACTAGCGTAGGTCGCTGCGCCCGCCGGATGGCTTCGAGGTATCGGAGTCTAGATGGGAGCGTGTCCATAAGTAGTTCGTCGTGTTACTTGGCGAAGGCGTATCGTCCTCAAGAATGTCCTCCACTCAGGTCATTTGATGATCTAGATTGACTAGGAGAGGTTTACGACACCTAGTGCCGGGCCGATCTAACTCACTTTATCGAAAGTTGTCCAACCTGACACTAAACACCTACCAATGCCGGTCAGTAGGCGTAATTCCAGAACCCCCTAGGCAGCACATCGTCAAAGGTCCCCATTCATCATGGTCGTATATCATGAGACTCTTCCGGCTATGACACCTCTAGAAGGTCAACACAATATCATCCAACCCGTTAGACTTTGGGAGTGGGACTTAAATTTAGTAGGTCGCCTACGAAGGAACTTGATACCTTCAGTTAGGAAGCCATAGTCCCATTCGAATTCCTATACGCTCTCGTTAGTCGCCGGCTATTTTGCGGCTTGGCTCGTTAGGATAATCCTGTACGGTATTTTACCTTTGTGTTAGCGTTTATCCTGCGTAACGATGCACCTTTACTCGACCGCTCTTATGGAAAACCACGGACCGTGAAAATTCTGGGCTGATAGCGACCTTTTTAAGTTGATGTCGTGTCTCGGAGCAACCTTCAGTTCTAGACCCATATAGTATGAAATCAAATATTG';
s10 = 'AACAGCAAGCGCCGATTAGCCATACACCTCATTTGCTGCAGGAGTCTTTTATGATCAACGACTGCTGGACGTTGAATGGTCTTAGAGCTCATAGGGCTCCGAGCTGATTCCCTCATGTCGTACTAATTTGCCCGCTGATGTTCTGATTCCGTGCAAGCATTTCTAAAAATAAGTCAGATTTTACGGGATTCGAATTCCAAGCCCTATACTGTGAGCCGGTATTTACAAGTGAAAAGCCGACAGAACTCAAAAATACAATCAGTGCCATAGATGTTTTCGGCCATCGAATCGGGGTCAGTCTCCTTCTGAAGACCCATTCGAATTCCAGCTATTTCGTACCTAAAGTCCAGAAGCTAAATAACATATAGTTCTCCTAACCGAGGCATTCGAATTCCGGACGTACGGCCAGTATACCATATCGAATTCGAATTCACTCCGGCGCAGTGCCGGAATACTTCCGTTAAGCCGAACGATAGGCCCTGTTCAAATCCAGCTCTATCTGCGCACACCTAATCACGGCCGTTCAGAGGATACCATCGAGCGAACAGGAACTCGTCTGGGAAATACAGGGAATATTTTCCCCCCCTCCGGCACACCAAAGGTACTTATGTAGTCTATCAGGCATGTTGCCGACCCCGAGTGGATTGCCACCCGAAGTTTTCCTCTGGTTGCGCGTTTTTTCCCATTTCGCTGAGGTGTATGCACTTCGCAATCCGGACCTCCCGGGACATTCGAATTCAACTGTTCCAACTAAACTTAGCTTAAATTCGAATTCTAACGACTATCCACGAGTAAAAGCTTGACCCATTCTATCCGGGTCATTCATTCGTACGCTACATATCGTGGTTCGTGATCAAAGGCCGAAATCCCCAACGATTGTCGATCAGCTCTCTTATTGTAAACTCGAACCTTCCGTTCGCGTATTATCCTAGGCCCGGAATCTCCCTTCACGCAACGGAAAGGTGGGTAATCGTAATCCGGCGAGTGCATAGGTAGCCCGTTCCACGTCAATGCCATCAT'; %AAGAGGACCTTGATTAACTCGCACACATGCCTAACGGGCG';

seq_array_artificial = [s1;s2;s3;s4;s5;s6;s7;s8;s9;s10];

w = 10;
Q_0 = 0.25*ones(4,1);
%[A, a_mat] = A_ij(seq_array, Q_0, w);


Acon = converge_A(seq_array_artificial, Q_0, w, 200);

%Acon = converge_A(seq_array, Q_0, w, 1);

s = string_Acon(seq_array_artificial, Acon,w);
    
%hmmm = A + A1 + A2 + A3 + A4 + A5 + A6 + A7